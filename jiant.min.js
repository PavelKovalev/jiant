var jiant=jiant||function(d){function D(a,b,c,f){if(!c||!a.dirtyList||!(0<=d.inArray(c,a.dirtyList)||a.appPrefix&&0<=d.inArray(c.substring(a.appPrefix.length),a.dirtyList)))if(!b||!b.length)window.console&&window.console.error&&(f?x("non existing object referred by class under object id '"+c+"', check stack trace for details, expected obj class: "+f):x("non existing object referred by id, check stack trace for details, expected obj id: "+c)),y=f?y+("   ,    #"+c+" ."+f):y+(", #"+c),F=!1}function G(a,
b,c){jiant.DEV_MODE&&a.click(function(d){if(d.shiftKey&&d.altKey){var e=b+(c?"."+c:"");d.ctrlKey&&(e=e+"\r\n------------\r\n"+O(jQuery._data(a[0],"events")));r(e);alert(e);d.preventDefault();d.stopImmediatePropagation()}})}function O(a){var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);var c=[],f=a&&a.constructor==Array;d.each(a,function(a,d){b=typeof d;"string"==b?d='"'+d+'"':"object"==b&&null!==d&&(d=O(d));c.push((f?"":'"'+a+'":')+(d?d:'""'))});return(f?"[":"{")+
String(c)+(f?"]":"}")}function t(a){return 10>a?"0"+a:a}function z(a,b){b=b||{};var c=d.trim(d(a).html()),f={},e="";jiant.isMSIE?(c=d(a),d.each(c.find("*"),function(b,a){d.each(a.attributes,function(b,c){0>c.value.indexOf(" ")&&0<=c.value.indexOf("!!")&&d(a).attr(c.name,c.value.replace(/!!/g,"e2013e03e11eee "))})}),c=d.trim(d(c).html()).replace(/!!/g,"!! ").replace(/e2013e03e11eee /g,"!! ")):c=c.replace(/!!/g,"!! ");try{var l=f[c];if(!l){var h="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+
c.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/!! (.+?)!! /g,"',$1,'").split("!?").join("');").split("?!").join("p.push('")+"');}return p.join('');",l=new Function("obj",h);f[c]=l}return d.trim(l(b))}catch(g){e=g.message}return"!!! ERROR: "+e.toString()+" !!!"}function x(a){d.each(arguments,function(b,a){window.console&&window.console.error&&window.console.error(a)})}function r(a){jiant.DEV_MODE&&(window.console&&window.console.info)&&
d.each(arguments,function(b,a){window.console.info(a)})}function j(a){return window.console&&window.console.error?(window.console.error(a),!0):!1}function P(a,b,c,f,e){if((c==Q||c.tabsTmInner)&&b.tabs)b.tabs(),b.refreshTabs=function(){b.tabs("refresh")};else if(c==H||c.inputIntTmInner)b.keydown(function(a){if(a.keyCode==jiant.key.down&&0<b.val())return b.val(b.val()-1),!1;if(a.keyCode==jiant.key.up)return b.val(parseInt(b.val())+1),!1;if(!(a.keyCode==jiant.key.backspace||a.keyCode==jiant.key.del||
a.keyCode==jiant.key.end||a.keyCode==jiant.key.home||a.keyCode==jiant.key.tab||a.keyCode==jiant.key.enter))if(a.shiftKey||(48>a.keyCode||57<a.keyCode)&&(96>a.keyCode||105<a.keyCode))return a.preventDefault(),!1;return!0});else if((c==I||c.inputDateTmInner)&&b.datepicker)b.datepicker();else if(c==J||c.pagerTmInner){var l=function(b,a){var c=d(z(d("<b><li class='!!ctlClass!!' style='cursor: pointer;'><a>!!label!!</a></li></b>"),{label:b,ctlClass:a}));g.append(c);c.click(function(){h.trigger("ValueChange",
b)});return c},h=d({}),g=d("<ul></ul>");b.addClass("pagination");b.append(g);b.onValueChange=function(b){h.on("ValueChange",b)};b.updatePager=function(b){g.empty();var a=Math.max(0,b.number-jiant.PAGER_RADIUS/2),c=Math.min(b.number+jiant.PAGER_RADIUS/2,b.totalPages);for(0<a&&l(1,"").find("a").css("margin-right","20px");a<c;a++){var d="";a==b.number&&(d+=" active");l(a+1,d)}c<b.totalPages-1&&l(b.totalPages,"").find("a").css("margin-left","20px")}}else if(c==K||c.formTmInner)b[0]&&(c=b[0].tagName.toLowerCase(),
"form"!=c&&(jiant.logError(f+"."+e+" form element assigned to non-form: "+c),jiant.DEV_MODE&&alert(f+"."+e+" form element assigned to non-form: "+c)),b.submitForm=function(c,e){c=c?c:b.attr("action");a.ajaxPrefix?c=a.ajaxPrefix+c:jiant.AJAX_PREFIX&&(c=jiant.AJAX_PREFIX=c);a.ajaxSuffix?c+=a.ajaxSuffix:jiant.AJAX_SUFFIX&&(c+=jiant.AJAX_SUFFIX);var f={type:"POST",url:c,data:b.serialize(),success:e};a.crossDomain&&(f.contentType="application/json",f.dataType="jsonp",f.xhrFields={withCredentials:!0},f.crossDomain=
!0);return d.ajax(f)});else if(c==L||c.containerPagedTmInner){var j=function(){p=Math.max(p,0);p=Math.min(p,u.children().length-1);k.css("visibility",0<p?"visible":"hidden");m.css("visibility",p<u.children().length-n?"visible":"hidden");d.each(u.children(),function(b,a){var c=d(a);b>=p&&b<p+n?c.show():c.hide()})},k=d("<div>&lt;&lt;</div>"),m=d("<div>&gt;&gt;</div>"),u=d("<div></div>"),n=8,p=0;k.addClass("paged-prev");m.addClass("paged-next");u.addClass("paged-container");b.empty();b.append(k);b.append(u);
b.append(m);k.click(function(){p-=n;j()});m.click(function(){p+=n;j()});b.append=function(b){u.append(b);j()};b.empty=function(){u.empty();j()};b.setHorizontal=function(b){b=b?"inline-block":"block";k.css("display",b);m.css("display",b);u.css("display",b)};b.setPageSize=function(b){n=b;j()};b.setHorizontal(!0)}G(b,f,e)}function A(){var a={stack:{}};Error.captureStackTrace&&Error.captureStackTrace(a,A);return a.stack}function R(a,b){var c={};d.each(a,function(b,a){c[b]=a});return function(f,e){e=void 0==
e?!0:e;d.each(c,function(c,h){if(void 0!=f[c]&&null!=f[c]){var g=f[c];h=b[c];if(d.isFunction(g)){if(M(a,c)(f,h,g()),e&&d.isFunction(g.on))g.on(function(b,d){M(a,c)(f,h,d,!0)})}else M(a,c)(f,h,g)}})}}function M(a,b){return a[b]&&a[b].customRenderer&&d.isFunction(a[b].customRenderer)?a[b].customRenderer:ca}function ca(a,b,c){if(b&&b[0]){a=["text","hidden",void 0];var f=b[0].tagName.toLowerCase();"input"==f||"textarea"==f?(f=d(b[0]).attr("type"),0<=d.inArray(f,a)?b.val(c):"radio"==f&&d.each(b,function(b,
a){d(a).prop("checked",a.value==c)})):"img"==f?b.attr("src",c):b.html(c)}}function da(a){switch(a){case S:return"labelTmInner";case T:return"ctlTmInner";case U:return"containerTmInner";case L:return"containerPagedTmInner";case K:return"formTmInner";case J:return"pagerTmInner";case V:return"imageTmInner";case W:return"gridTmInner";case X:return"inputTmInner";case H:return"inputIntTmInner";case I:return"inputDateTmInner";default:return"customTmInner"}}function s(a,b,c){var f=function(e){var f;jiant.DEBUG_MODE.events&&
(j("assigning event handler to "+b),k[b]&&j(" !!! Event handler assigned after fire occured, possible error, for event "+b),f=A());c?a[c].listenersCount++:a.listenersCount++;a._innerData.on(b,function(){jiant.DEBUG_MODE.events&&j("called event handler: "+b+", registered at "+f);var a=d.makeArray(arguments);a.splice(0,1);e&&e.apply(e,a)})};c?(a[c].on=f,a[c].listenersCount=0):(a.on=f,a.listenersCount=0)}function N(a,b,c){var f=[];b.updateAll&&b.id&&(b.addAll||(b.addAll=function(){}),b.update||(b.update=
function(){}),b.findById||(b.findById=function(){}));c._innerData=d({});d.each(b,function(e,l){var h=a+"_"+e+"_event",g=a+"_globalevent";if("_innerData"!=e)if("all"==e)c[e]=function(){return f};else if("on"==e)s(c,g);else if("update"==e)c[e]=function(a){var f=!1,n={};d.each(a,function(b,a){c[b]&&(d.isFunction(c[b])&&c[b]()!=a)&&(c[b](a,!1),f=n[b]=!0)});d.each(n,function(b){c[b](c[b](),!0)});f&&(jiant.DEBUG_MODE.events&&j("fire event: "+h),jiant.DEBUG_MODE.events&&!k[h]&&(k[h]=1),c._innerData.trigger(h,
c),c!=b&&b._innerData.trigger(h,c),jiant.DEBUG_MODE.events&&j("fire event: "+g),jiant.DEBUG_MODE.events&&!k[g]&&(k[g]=1),q.trigger(g,[c,e]))},s(c,h,e);else if("updateAll"==e)c[e]=function(a){function e(a){if(b.id){var d=c.findById(a.id);0==d.length?c.addAll(a):d[0].update(a)}else c.update(a)}d.isArray(a)?d.each(a,function(b,a){e(a)}):e(a)},s(c,h,e);else if("add"==e){var r=Y(l);c[e]=function(){var m={};d.each(arguments,function(b,a){r[b]&&(m["fld_prefix_"+r[b]]=a)});f.push(m);N(a,b,m);jiant.DEBUG_MODE.events&&
j("fire event: "+h);jiant.DEBUG_MODE.events&&!k[h]&&(k[h]=1);c._innerData.trigger(h,m);jiant.DEBUG_MODE.events&&j("fire event: "+g);jiant.DEBUG_MODE.events&&!k[g]&&(k[g]=1);q.trigger(g,[m,e]);return m};s(c,h,e)}else if("addAll"==e)c[e]=function(m){function l(c){var e={};f.push(e);n.push(e);N(a,b,e);d.each(c,function(b,a){e[b]&&e[b](a)})}var n=[];d.isArray(m)?d.each(m,function(b,a){l(a)}):l(m);jiant.DEBUG_MODE.events&&j("fire event: "+h);jiant.DEBUG_MODE.events&&!k[h]&&(k[h]=1);c._innerData.trigger(h,
[n]);jiant.DEBUG_MODE.events&&j("fire event: "+g);jiant.DEBUG_MODE.events&&!k[g]&&(k[g]=1);q.trigger(g,[n,e]);d.isArray(m)?d.each(m,function(b,a){n[b].update&&n[b].update(a)}):n.update&&n.update(m);return n},s(c,h,e);else if("remove"==e)c[e]=function(b){var a=f.length;f=d.grep(f,function(a){return a!=b});f.length!=a&&(jiant.DEBUG_MODE.events&&j("fire event: "+h),jiant.DEBUG_MODE.events&&!k[h]&&(k[h]=1),c._innerData.trigger(h,b),jiant.DEBUG_MODE.events&&j("fire event: "+g),jiant.DEBUG_MODE.events&&
!k[g]&&(k[g]=1),q.trigger(g,[b,e]));return b},s(c,h,e);else if(0==e.indexOf("findBy")&&6<e.length){var v="fld_prefix_"+e.substring(6,7).toLowerCase()+e.substring(7);c[e]=function(b){return d.grep(f,function(a){return a[v]==b})}}else if((""+l).indexOf("{}")==(""+l).length-2||b._innerData[e])b._innerData[e]=!0,c[e]=function(a,d){var f="fld_prefix_"+e;0!=arguments.length&&(d||c[f]!==a&&!1!==d?(c[f]=a,jiant.DEBUG_MODE.events&&j("fire event: "+h),jiant.DEBUG_MODE.events&&!k[h]&&(k[h]=1),c._innerData.trigger(h,
[c,a]),c!=b&&b._innerData.trigger(h,[c,a]),jiant.DEBUG_MODE.events&&j("fire event: "+g),jiant.DEBUG_MODE.events&&!k[g]&&(k[g]=1),q.trigger(g,[c,e,a])):c[f]=a);return c[f]},s(c,h,e)})}function Z(a,b){var c="now="+a.now+"|root="+a.root,d=b||""==b?b:jiant.STATE_EXTERNAL_BASE;d?window.location.assign(d+"#"+c):location.hash="#"+c}function B(){var a=location.hash.substring(1).split("|"),b={};d.each(a,function(a,f){var e=f.split("="),j=[];2<=e.length&&(j=e[1].split(","));b[e[0]]=[];d.each(j,function(a,c){b[e[0]].push(c?
c.replace(/;3/g,"|").replace(/;2/g,"=").replace(/;1/g,",").replace(/;;/g,";"):"")})});b.now=b.now||[];b.root=b.root||[];return b}function w(a){return a?a.replace(/;/g,";;").replace(/,/g,";1").replace(/=/g,";2").replace(/\|/g,";3"):""}function Y(a){a=a.toString();return a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g)}function $(a,b,c){d.isArray(c)?a[b]=c:d.isPlainObject(c)?d.each(c,function(b,c){$(a,b,c)}):a[b]=c}function aa(a,b,c){jiant.DEV_MODE=c;!c&&0<=(window.location+"").toLowerCase().indexOf("jiant.dev_mode")&&
(jiant.DEV_MODE=!0);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_events")&&(jiant.DEBUG_MODE.events=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_states")&&(jiant.DEBUG_MODE.states=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_ajax")&&(jiant.DEBUG_MODE.ajax=1);y="";F=!0;var f=b.id?b.id:"no_app_id";b.id?jiant.logInfo("Loading application, id: "+b.id):jiant.logError("!!! Application id not specified. Not recommended since 0.20. Use 'id' property of application root to specify application id");
if(b.views){var e=a,l=b.views,e=e||"";d.each(l,function(a,c){r("binding UI for view: "+a);var f=d("#"+e+a);D(b,f,e+a);var h=l[a],g=e;d.each(c,function(c,d){if(h[c]==ba)r("    loookup element, no checks/bindings: "+c),h[c]=function(){return f.find("."+g+c)};else{var e=f.find("."+g+c);D(b,e,g+a,g+c);h[c]=e;P(b,e,d,a,c)}});d.each(l[a],function(a){f[a]&&(x("unsafe extension: "+a+" already defined in base jQuery, shouldn't be used, now overriding!"),f[a]=void 0)});l[a].propagate=R(c,c);d.extend(l[a],f);
G(f,a,void 0)})}else b.views={};if(b.templates){var h=a,g=b.templates,h=h||"";d.each(g,function(a,c){r("binding UI for template: "+a);var e=d("#"+h+a);D(b,e,h+a);d.each(c,function(d){D(b,e.find("."+h+d),h+a,h+d);var f=da(c[d]);c[d]={};c[d][f]=!0});g[a].parseTemplate=function(f){var j=d("\x3c!-- --\x3e"+z(e,f));d.each(c,function(c){"parseTemplate"!=c&&"parseTemplate2Text"!=c&&(j[c]=d.merge(j.filter("."+h+c),j.find("."+h+c)),P(b,j[c],g[a][c],a,c),G(j[c],a,c))});j.splice(0,1);j.propagate=R(c,j);return j};
g[a].parseTemplate2Text=function(a){return z(e,a)}})}else b.templates={};if(b.ajax){var s=b.ajax,t=b.ajaxPrefix,m=b.ajaxSuffix,u=b.crossDomain;d.each(s,function(a,b){r("binding ajax for function: "+a);var c=Y(b);c.splice(c.length-1,1);var e=d.isFunction(s[a])?s[a]():void 0;s[a]=function(){var b={},f,h,g=arguments;d.isFunction(g[g.length-2])?(f=g[g.length-2],h=g[g.length-1]):d.isFunction(g[g.length-1])&&(f=g[g.length-1]);d.each(c,function(a,c){a<g.length&&(!d.isFunction(g[a])&&void 0!=g[a]&&null!=
g[a])&&$(b,c,g[a])});b.antiCache3721||(b.antiCache3721=(new Date).getTime());var k=t||""==t?t:jiant.AJAX_PREFIX,l=m||""==m?m:jiant.AJAX_SUFFIX,k=e?e:k+a+l;r("    AJAX call. "+a+" to server url: "+k);l={data:b,traditional:!0,success:function(b){if(f){try{b=d.parseJSON(b)}catch(c){}jiant.DEBUG_MODE.ajax&&j("Ajax call results for uri "+a)&&j(b);f(b)}},error:function(a){h?h(a.responseText):jiant.handleErrorFn(a.responseText)}};u&&(l.contentType="application/json",l.dataType="jsonp",l.xhrFields={withCredentials:!0},
l.crossDomain=!0);d.ajax(k,l)}})}else b.ajax={};if(b.events){var n=b.events;d.each(n,function(a){r("binding event: "+a);n[a].listenersCount=0;n[a].fire=function(){jiant.DEBUG_MODE.events&&j("fire event: "+a);jiant.DEBUG_MODE.events&&!k[a]&&(k[a]=1);q.trigger(a+".event",arguments)};n[a].on=function(b){var c;jiant.DEBUG_MODE.events&&(j("assigning event handler to: "+a),k[a]&&j(" !!! Event handler assigned after fire occured, possible error, for event "+a),c=A());n[a].listenersCount++;q.on(a+".event",
function(){jiant.DEBUG_MODE.events&&j("called event handler: "+a+", registered at "+c);var e=d.makeArray(arguments);e.splice(0,1);b&&b.apply(b,e)})}})}else b.events={};if(b.states){a=b.states;var p=b.stateExternalBase;d(window).hashchange?(d.each(a,function(a,b){r("binding state: "+a);var c=b.root;b.go=function(){var b=B(),e=b.now;b.now=[a];d.each(arguments,function(c,d){void 0!=d?b.now.push(w(d+"")):e[0]==a&&void 0!=e[c+1]?b.now.push(w(e[c+1]+"")):b.now.push(w(d+""))});c?(b.root=[],d.each(b.now,
function(a,c){b.root.push(c)})):d.each(b.root,function(a,c){b.root[a]=w(c)});Z(b,p)};b.start=function(b){var c;jiant.DEBUG_MODE.states&&(j("register state start handler: "+a),E[a]&&j(" !!! State start handler registered after state triggered, possible error, for state "+a),c=A());q.on("state_"+a+"_start",function(){jiant.DEBUG_MODE.states&&j("called state start handler: "+a+", registered at "+c);var e=d.makeArray(arguments);e.splice(0,1);b&&b.apply(b,e)});var e=B();if(C[f]&&(""==a&&0==e.now.length||
e.now[0]==a))e=e.now,e.splice(0,1),b&&b.apply(b,e)};b.end=function(b){var c;jiant.DEBUG_MODE.states&&(j("register state end handler: "+a),E[a]&&j(" !!! State end handler registered after state triggered, possible error, for state "+a),c=A());q.on("state_"+a+"_end",function(){jiant.DEBUG_MODE.states&&j("called state end handler: "+a+", registered at "+c);var e=d.makeArray(arguments);e.splice(0,1);b&&b.apply(b,e)})}}),d(window).hashchange(function(){var a=location.hash.substring(1),b=B(),c=b.now[0],
e=b.now;jiant.logInfo(a);e.splice(0,1);d.each(e,function(a,b){"undefined"==b&&(e[a]=void 0)});void 0!=v&&v!=c&&(jiant.DEBUG_MODE.states&&j("trigger state end: "+(v?v:"")),q.trigger("state_"+v+"_end"));c=(v=c)?c:"";jiant.DEBUG_MODE.states&&j("trigger state start: "+c);jiant.DEBUG_MODE.states&&!E[c]&&(E[c]=1);q.trigger("state_"+c+"_start",e)}),v=B().now[0]):(jiant.logError("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"),jiant.DEV_MODE&&
alert("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"))}else b.states={};b.models?d.each(b.models,function(a,b){jiant.logInfo("implementing model "+a);N(a,b,b)}):b.models={};jiant.DEV_MODE&&!F&&alert("Some elements not bound to HTML properly, check console"+y);C[f]=b;q.trigger("jiant_uiBound_"+f)}var U={},L={},T={},K={},W={},V={},X={},H={},I={},S={},ba=function(){},J={},Q={},v=void 0,q=d({}),F=!0,C={},y,E={},k={};return{AJAX_PREFIX:"",
AJAX_SUFFIX:"",DEV_MODE:!1,DEBUG_MODE:{states:0,events:0,ajax:0},PAGER_RADIUS:6,isMSIE:eval("/*@cc_on!@*/!1"),STATE_EXTERNAL_BASE:void 0,bind:function(a,b){d.extend(a,b)},bindUi:function(a,b,c,f,e){var j=(new Date).getMilliseconds();d.isPlainObject(a)&&(e=f,f=c,c=b,b=a,a=b.appPrefix);f?(e?d("#"+e):d("body")).load(f,{},function(){aa(a,b,c)}):aa(a,b,c);jiant.logInfo("UI bound in "+((new Date).getMilliseconds()-j)+"ms")},goRoot:function(){var a=B();a.now=[];d.each(a.root,function(b,c){a.now.push(w(c));
a.root[b]=w(c)});Z(a,void 0)},goState:function(){},onUiBound:function(a,b){b?d.isPlainObject(a)&&(a=a.id):(jiant.logError("!!! Registering anonymous logic without application id. Not recommended since 0.20"),b=a,a="no_app_id");if(C[a])b&&b(d,C[a]);else q.on("jiant_uiBound_"+a,function(){b&&b(d,C[a])})},refreshState:function(){d(window).hashchange&&d(window).hashchange()},handleErrorFn:function(a){x(a)},logInfo:r,logError:x,parseTemplate:function(a,b){return d(z(a,b))},parseTemplate2Text:function(a,
b){return z(a,b)},collection:{},container:U,containerPaged:L,ctl:T,fn:function(){},form:K,formatDate:function(a){return d.datepicker.formatDate("yy-mm-dd",new Date(a))},formatTime:function(a){a=new Date(a);return t(a.getHours())+":"+t(a.getMinutes())},formatTimeSeconds:function(a){a=new Date(a);return t(a.getHours())+":"+t(a.getMinutes())+":"+t(a.getSeconds())},grid:W,image:V,input:X,inputDate:I,inputInt:H,label:S,lfill:t,lookup:ba,on:function(){},pager:J,slider:{},stub:function(){var a="not available";
arguments&&(arguments.callee&&arguments.callee.caller)&&(a=arguments.callee.caller.name);alert("stub called from function: "+a)},tabs:Q,key:{left:37,up:38,right:39,down:40,del:46,backspace:8,tab:9,end:35,home:36,enter:13,ctrl:17,escape:27,a:65,c:67,u:85,w:87,space:32,1:49,2:50,3:51,4:52,5:53,6:54}}}(jQuery);
